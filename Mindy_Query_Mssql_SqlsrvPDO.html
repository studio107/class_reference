<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta name="language" content="en"/>
    <link rel="stylesheet" type="text/css" href="css/style.css"/>
    <link rel="stylesheet" type="text/css" href="css/api.css"/>
    <script type="text/javascript" src="js/jquery.js"></script>
    <title></title>
</head>

<body>
<div id="apiPage">

    <div id="apiHeader">
        Mindy Class Reference
    </div>
    <!-- end of header -->

    <div id="content">
        <h1>Mindy\Query\Mssql\SqlsrvPDO</h1>
<div id="nav">
    <a href="/">All Packages</a>
                | <a href="#methods">Methods</a>
        </div>

<table class="summaryTable docClass">
    <colgroup>
        <col class="col-name"/>
        <col class="col-value"/>
    </colgroup>
        <tr>
        <th>Inheritance</th>
        <td>class Mindy\Query\Mssql\SqlsrvPDO &raquo;
PDO</td>
    </tr>
                    <tr>
            <th>Since</th>
            <td>2.0</td>
        </tr>
                <tr>
        <th>Source Code</th>
        <td><a href="http://code.google.com/p/yii/source/browse/tags/0.9/framework/Volumes/mac/Users/max/projects/mindy/app/vendor/mindy/query/src/Mindy/Query/Mssql/SqlsrvPDO.php" class='sourceLink'>framework/Volumes/mac/Users/max/projects/mindy/app/vendor/mindy/query/src/Mindy/Query/Mssql/SqlsrvPDO.php</a></td>
    </tr>
            <tr>
            <th>Author</th>
            <td>Timur Ruziev <resurtm@gmail.com></td>
        </tr>
    </table>

<div id="classDescription">
    This is an extension of the default PDO class of SQLSRV driver.
It provides workarounds for improperly implemented functionalities of the SQLSRV driver.</div>
<a name="properties"></a>

<a name="methods"></a>

<div class="summary docMethod">
<h2>Public Methods</h2>

<p><a href="#" class="toggle">Hide inherited methods</a></p>

<table class="summaryTable">
<colgroup>
	<col class="col-method" />
	<col class="col-description" />
	<col class="col-defined" />
</colgroup>
<tr>
  <th>Method</th><th>Description</th><th>Defined By</th>
</tr>
<tr class="inherited" id="__construct">
  <td>__construct()</td>
  <td></td>
  <td>PDO</td>
</tr>
<tr class="inherited" id="__sleep">
  <td>__sleep()</td>
  <td></td>
  <td>PDO</td>
</tr>
<tr class="inherited" id="__wakeup">
  <td>__wakeup()</td>
  <td></td>
  <td>PDO</td>
</tr>
<tr class="inherited" id="beginTransaction">
  <td>beginTransaction()</td>
  <td></td>
  <td>PDO</td>
</tr>
<tr class="inherited" id="commit">
  <td>commit()</td>
  <td></td>
  <td>PDO</td>
</tr>
<tr class="inherited" id="errorCode">
  <td>errorCode()</td>
  <td></td>
  <td>PDO</td>
</tr>
<tr class="inherited" id="errorInfo">
  <td>errorInfo()</td>
  <td></td>
  <td>PDO</td>
</tr>
<tr class="inherited" id="exec">
  <td>exec()</td>
  <td></td>
  <td>PDO</td>
</tr>
<tr class="inherited" id="getAttribute">
  <td>getAttribute()</td>
  <td></td>
  <td>PDO</td>
</tr>
<tr class="inherited" id="getAvailableDrivers">
  <td>getAvailableDrivers()</td>
  <td></td>
  <td>PDO</td>
</tr>
<tr class="inherited" id="inTransaction">
  <td>inTransaction()</td>
  <td></td>
  <td>PDO</td>
</tr>
<tr id="lastInsertId">
  <td><a href="/Mindy_Query_Mssql_SqlsrvPDO#lastInsertId-detail">lastInsertId()</a></td>
  <td>Returns value of the last inserted ID.</td>
  <td>Mindy\Query\Mssql\SqlsrvPDO</td>
</tr>
<tr class="inherited" id="prepare">
  <td>prepare()</td>
  <td></td>
  <td>PDO</td>
</tr>
<tr class="inherited" id="query">
  <td>query()</td>
  <td></td>
  <td>PDO</td>
</tr>
<tr class="inherited" id="quote">
  <td>quote()</td>
  <td></td>
  <td>PDO</td>
</tr>
<tr class="inherited" id="rollBack">
  <td>rollBack()</td>
  <td></td>
  <td>PDO</td>
</tr>
<tr class="inherited" id="setAttribute">
  <td>setAttribute()</td>
  <td></td>
  <td>PDO</td>
</tr>
</table>
</div>
<a name="events"></a>

<h2>Method Details</h2>

<div class="detailHeader" id="lastInsertId-detail">
lastInsertId()
<span class="detailHeaderTag">
method
</span>
</div>

<table class="summaryTable">
<tr><td colspan="3">
<div class="signature2">
public integer <b>lastInsertId</b>(string|null $sequence=NULL)</div>
</td></tr>
<tr>
  <td class="paramNameCol">$sequence</td>
  <td class="paramTypeCol">string|null</td>
  <td class="paramDescCol">the sequence name. Defaults to null.</td>
</tr>
<tr>
  <td class="paramNameCol">{return}</td>
  <td class="paramTypeCol">integer</td>
  <td class="paramDescCol">last inserted ID value.</td>
</tr>
</table>

<div class="sourceCode">
<b>Source Code:</b> <a href="http://code.google.com/p/yii/source/browse/tags/0.9/framework/Volumes/mac/Users/max/projects/mindy/app/vendor/mindy/query/src/Mindy/Query/Mssql/SqlsrvPDO.php#29" class='sourceLink'>framework/Volumes/mac/Users/max/projects/mindy/app/vendor/mindy/query/src/Mindy/Query/Mssql/SqlsrvPDO.php#29</a> (<b><a href="#" class="show">show</a></b>)
<div class="code"><code><span style="color: #000000">
<span style="color: #0000BB"></span><span style="color: #007700">public&nbsp;function&nbsp;</span><span style="color: #0000BB">lastInsertId</span><span style="color: #007700">(</span><span style="color: #0000BB">$sequence&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">null</span><span style="color: #007700">)<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;!</span><span style="color: #0000BB">$sequence&nbsp;</span><span style="color: #007700">?&nbsp;</span><span style="color: #0000BB">parent</span><span style="color: #007700">::</span><span style="color: #0000BB">lastInsertId</span><span style="color: #007700">()&nbsp;:&nbsp;</span><span style="color: #0000BB">parent</span><span style="color: #007700">::</span><span style="color: #0000BB">lastInsertId</span><span style="color: #007700">(</span><span style="color: #0000BB">$sequence</span><span style="color: #007700">);<br />}</span>
</span>
</code></div>
</div>
<p>Returns value of the last inserted ID.
<br/><br/>
SQLSRV driver implements [[PDO::lastInsertId()]] method but with a single peculiarity:
when `$sequence` value is a null or an empty string it returns an empty string.
But when parameter is not specified it works as expected and returns actual
last inserted ID (like the other PDO drivers).</p>


    </div>
    <!-- end of content -->

    <div id="apiFooter">
        Copyright &copy; 2008-2011 by <a href="http://mindy-cms.com">Mindy</a><br/>
        All Rights Reserved.<br/>
    </div>
    <!-- end of footer -->

    <script type="text/javascript">
        /*<![CDATA[*/
        $("a.toggle").toggle(function () {
            $(this).text($(this).text().replace(/Hide/, 'Show'));
            $(this).parents(".summary").find(".inherited").hide();
        }, function () {
            $(this).text($(this).text().replace(/Show/, 'Hide'));
            $(this).parents(".summary").find(".inherited").show();
        });
        $(".sourceCode a.show").toggle(function () {
            $(this).text($(this).text().replace(/show/, 'hide'));
            $(this).parents(".sourceCode").find("div.code").show();
        }, function () {
            $(this).text($(this).text().replace(/hide/, 'show'));
            $(this).parents(".sourceCode").find("div.code").hide();
        });
        $("a.sourceLink").click(function () {
            $(this).attr('target', '_blank');
        });
        /*]]>*/
    </script>

</div>
<!-- end of page -->
</body>
</html>